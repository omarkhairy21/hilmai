---
// Investment Return Calculator Component
---

<div class="investment-calculator max-w-4xl mx-auto">
  <!-- Calculator Form -->
  <div class="bg-gray-900/50 border border-gray-800 rounded-2xl p-8 mb-8">
    <h3 class="text-2xl font-bold text-white mb-6">Calculate Investment Growth</h3>
    
    <div class="space-y-6">
      <!-- Initial Investment -->
      <div>
        <label for="initial-investment" class="block text-sm font-medium text-gray-300 mb-2">
          Initial Investment
        </label>
        <div class="relative">
          <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">$</span>
          <input
            type="number"
            id="initial-investment"
            class="w-full pl-8 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#d4ff2a] focus:ring-1 focus:ring-[#d4ff2a] transition-colors"
            placeholder="10000"
            min="0"
            step="0.01"
            value="0"
          />
        </div>
      </div>

      <!-- Monthly Contribution -->
      <div>
        <label for="investment-monthly-contribution" class="block text-sm font-medium text-gray-300 mb-2">
          Monthly Contribution (Optional)
        </label>
        <div class="relative">
          <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">$</span>
          <input
            type="number"
            id="investment-monthly-contribution"
            class="w-full pl-8 pr-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#d4ff2a] focus:ring-1 focus:ring-[#d4ff2a] transition-colors"
            placeholder="500"
            min="0"
            step="0.01"
            value="0"
          />
        </div>
      </div>

      <!-- Annual Return Rate -->
      <div>
        <label for="investment-return-rate" class="block text-sm font-medium text-gray-300 mb-2">
          Expected Annual Return Rate (%)
        </label>
        <input
          type="number"
          id="investment-return-rate"
          class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#d4ff2a] focus:ring-1 focus:ring-[#d4ff2a] transition-colors"
          placeholder="7"
          min="0"
          max="100"
          step="0.1"
          value="7"
        />
        <p class="mt-2 text-sm text-gray-500">Expected annual return on your investment</p>
      </div>

      <!-- Investment Period -->
      <div>
        <label for="investment-years" class="block text-sm font-medium text-gray-300 mb-2">
          Investment Period (Years)
        </label>
        <input
          type="number"
          id="investment-years"
          class="w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#d4ff2a] focus:ring-1 focus:ring-[#d4ff2a] transition-colors"
          placeholder="10"
          min="1"
          max="100"
          step="1"
        />
      </div>

      <!-- Calculate Button -->
      <button
        id="calculate-investment"
        class="w-full px-6 py-3 bg-[#d4ff2a] text-black font-semibold rounded-lg hover:bg-[#c5f01a] transform hover:scale-105 transition-all shadow-lg shadow-[#d4ff2a]/20"
      >
        Calculate Investment Growth
      </button>
    </div>
  </div>

  <!-- Results Section -->
  <div id="investment-results" class="hidden">
    <!-- Final Value -->
    <div class="bg-gray-900/50 border border-gray-800 rounded-xl p-8 mb-6 text-center">
      <h4 class="text-lg font-semibold text-white mb-4">Projected Investment Value</h4>
      <p id="final-value" class="text-5xl font-bold text-[#d4ff2a] mb-2">$0</p>
      <p class="text-gray-400">After <span id="investment-years-display">0</span> years</p>
    </div>

    <!-- Summary Cards -->
    <div class="grid md:grid-cols-3 gap-6 mb-6">
      <div class="bg-gray-900/50 border border-gray-800 rounded-xl p-6">
        <h5 class="text-sm text-gray-400 mb-2">Total Contributed</h5>
        <p id="total-contributed" class="text-2xl font-bold text-white">$0</p>
      </div>
      <div class="bg-gray-900/50 border border-gray-800 rounded-xl p-6">
        <h5 class="text-sm text-gray-400 mb-2">Interest Earned</h5>
        <p id="total-interest" class="text-2xl font-bold text-[#d4ff2a]">$0</p>
      </div>
      <div class="bg-gray-900/50 border border-gray-800 rounded-xl p-6">
        <h5 class="text-sm text-gray-400 mb-2">Return Multiple</h5>
        <p id="return-multiple" class="text-2xl font-bold text-green-400">0x</p>
      </div>
    </div>

    <!-- Yearly Breakdown -->
    <div class="bg-gray-900/50 border border-gray-800 rounded-xl p-6">
      <h4 class="text-lg font-semibold text-white mb-4">Year-by-Year Growth</h4>
      <div id="yearly-breakdown" class="space-y-3 max-h-96 overflow-y-auto">
        <!-- Breakdown will be populated dynamically -->
      </div>
    </div>
  </div>
</div>

<script>
  import { calculateInvestmentGrowth, formatCurrency } from '../../lib/calculators/investment';

  const calculateBtn = document.getElementById('calculate-investment') as HTMLButtonElement;
  const resultsSection = document.getElementById('investment-results') as HTMLElement;

  calculateBtn.addEventListener('click', () => {
    const initialInvestment = parseFloat((document.getElementById('initial-investment') as HTMLInputElement).value) || 0;
    const monthlyContribution = parseFloat((document.getElementById('investment-monthly-contribution') as HTMLInputElement).value) || 0;
    const returnRate = parseFloat((document.getElementById('investment-return-rate') as HTMLInputElement).value) || 7;
    const years = parseFloat((document.getElementById('investment-years') as HTMLInputElement).value);

    if (initialInvestment <= 0 && monthlyContribution <= 0) {
      alert('Please enter an initial investment or monthly contribution');
      return;
    }

    if (!years || years <= 0) {
      alert('Please enter an investment period');
      return;
    }

    const result = calculateInvestmentGrowth(initialInvestment, monthlyContribution, returnRate, years);

    // Update main results
    document.getElementById('final-value')!.textContent = formatCurrency(result.finalValue);
    document.getElementById('investment-years-display')!.textContent = years.toString();
    document.getElementById('total-contributed')!.textContent = formatCurrency(result.totalContributed);
    document.getElementById('total-interest')!.textContent = formatCurrency(result.totalInterest);
    
    const returnMultiple = result.totalContributed > 0 
      ? (result.finalValue / result.totalContributed).toFixed(2)
      : '0';
    document.getElementById('return-multiple')!.textContent = `${returnMultiple}x`;

    // Update yearly breakdown
    const breakdownDiv = document.getElementById('yearly-breakdown')!;
    breakdownDiv.innerHTML = result.breakdown
      .map(
        (year) => `
      <div class="bg-gray-800 rounded-lg p-4">
        <div class="flex items-center justify-between mb-2">
          <span class="text-white font-semibold">Year ${year.year}</span>
          <span class="text-[#d4ff2a] font-bold">${formatCurrency(year.endingBalance)}</span>
        </div>
        <div class="grid grid-cols-3 gap-2 text-xs">
          <div>
            <span class="text-gray-400">Starting:</span>
            <span class="text-white ml-1">${formatCurrency(year.beginningBalance)}</span>
          </div>
          <div>
            <span class="text-gray-400">Added:</span>
            <span class="text-white ml-1">${formatCurrency(year.contributions)}</span>
          </div>
          <div>
            <span class="text-gray-400">Interest:</span>
            <span class="text-green-400 ml-1">${formatCurrency(year.interest)}</span>
          </div>
        </div>
      </div>
    `
      )
      .join('');

    resultsSection.classList.remove('hidden');
    resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  });
</script>

